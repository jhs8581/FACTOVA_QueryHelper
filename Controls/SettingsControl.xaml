<UserControl x:Class="FACTOVA_QueryHelper.Controls.SettingsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:FACTOVA_QueryHelper.Controls"
             mc:Ignorable="d" 
             d:DesignHeight="700" d:DesignWidth="1200"
             Background="#FFF8F9FA">
    <Grid Margin="20">
        <TabControl x:Name="SettingsTabControl"
                    Background="White"
                    BorderBrush="#FFE0E0E0"
                    BorderThickness="1">
            <TabControl.Resources>
                <!-- 탭 헤더 스타일 -->
                <Style TargetType="TabItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border x:Name="Border"
                                        Background="Transparent"
                                        BorderBrush="#FFE0E0E0"
                                        BorderThickness="1,1,1,0"
                                        CornerRadius="8,8,0,0"
                                        Padding="20,12"
                                        Margin="2,0,0,0">
                                    <ContentPresenter x:Name="ContentSite"
                                                      ContentSource="Header"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="White"/>
                                        <Setter TargetName="Border" Property="BorderBrush" Value="#FF0078D7"/>
                                        <Setter TargetName="Border" Property="BorderThickness" Value="2,2,2,0"/>
                                        <Setter Property="Panel.ZIndex" Value="100"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="False">
                                        <Setter TargetName="Border" Property="Background" Value="#FFF8F9FA"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="#FFF0F8FF"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="FontSize" Value="14"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Foreground" Value="#FF495057"/>
                </Style>
            </TabControl.Resources>

            <!-- 파일 경로 설정 탭 -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="📁" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="파일 경로 설정"/>
                    </StackPanel>
                </TabItem.Header>
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <!-- TNS 파일 경로 -->
                        <TextBlock Text="tnsnames.ora 파일 경로" 
                                   FontWeight="SemiBold" 
                                   FontSize="13"
                                   Margin="0,0,0,10"/>

                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBox x:Name="TnsPathTextBox" 
                                     Grid.Column="0"
                                     Height="36"
                                     VerticalContentAlignment="Center"
                                     Padding="10,0"
                                     Margin="0,0,10,0"
                                     IsReadOnly="True"
                                     Background="#FFF8F9FA"/>

                            <Button x:Name="BrowseButton" 
                                    Grid.Column="1"
                                    Width="110" 
                                    Height="36"
                                    Click="BrowseButton_Click"
                                    Background="#FF0078D7"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    FontWeight="SemiBold">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="📁" Margin="0,0,5,0"/>
                                    <TextBlock Text="찾아보기"/>
                                </StackPanel>
                            </Button>
                        </Grid>

                        <Border Background="#FFF0F8FF" 
                                BorderBrush="#FF0078D7" 
                                BorderThickness="1" 
                                CornerRadius="4"
                                Padding="10"
                                Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="기본 경로:" 
                                           FontSize="11" 
                                           Foreground="#FF6C757D"
                                           Margin="0,0,0,5"/>
                                <TextBlock x:Name="DefaultPathTextBlock" 
                                           FontSize="11" 
                                           Foreground="#FF495057"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <!-- 구분선 -->
                        <Rectangle Height="1" Fill="#FFE0E0E0" Margin="0,0,0,15"/>

                        <!-- 데이터베이스 파일 경로 -->
                        <TextBlock Text="FACTOVA_DB.db 파일 경로" 
                                   FontWeight="SemiBold" 
                                   FontSize="13"
                                   Margin="0,0,0,10"/>

                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBox x:Name="DatabasePathTextBox" 
                                     Grid.Column="0"
                                     Height="36"
                                     VerticalContentAlignment="Center"
                                     Padding="10,0"
                                     Margin="0,0,10,0"
                                     IsReadOnly="True"
                                     Background="#FFF8F9FA"/>

                            <Button x:Name="BrowseDatabaseButton" 
                                    Grid.Column="1"
                                    Width="110" 
                                    Height="36"
                                    Click="BrowseDatabaseButton_Click"
                                    Background="#FF0078D7"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    FontWeight="SemiBold">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="📁" Margin="0,0,5,0"/>
                                    <TextBlock Text="찾아보기"/>
                                </StackPanel>
                            </Button>
                        </Grid>

                        <Border Background="#FFF0F8FF" 
                                BorderBrush="#FF0078D7" 
                                BorderThickness="1" 
                                CornerRadius="4"
                                Padding="10"
                                Margin="0,0,0,10">
                            <StackPanel>
                                <TextBlock Text="기본 경로:" 
                                           FontSize="11" 
                                           Foreground="#FF6C757D"
                                           Margin="0,0,0,5"/>
                                <TextBlock x:Name="DefaultDatabasePathTextBlock" 
                                           FontSize="11" 
                                           Foreground="#FF495057"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <Border Background="#FFFEF5E7" 
                                BorderBrush="#FFFFC107" 
                                BorderThickness="1" 
                                CornerRadius="4"
                                Padding="10"
                                Margin="0,0,0,15">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="⚠️" 
                                           FontSize="14"
                                           Margin="0,0,8,0"/>
                                <TextBlock Text="DB 파일 경로 변경 후 프로그램을 재시작해야 적용됩니다." 
                                           FontSize="12" 
                                           Foreground="#FF856404"
                                           FontWeight="SemiBold"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <!-- 구분선 -->
                        <Rectangle Height="1" Fill="#FFE0E0E0" Margin="0,0,0,15"/>

                        <!-- 저장 버튼 -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="ResetButton" 
                                    Width="120" 
                                    Height="40"
                                    Click="ResetButton_Click"
                                    Background="#FF6C757D"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    FontWeight="SemiBold"
                                    Margin="0,0,10,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="↺" FontSize="16" Margin="0,0,5,0"/>
                                    <TextBlock Text="기본값 복원"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="SaveSettingsButton" 
                                    Width="120" 
                                    Height="40"
                                    Click="SaveSettingsButton_Click"
                                    Background="#FF28A745" 
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    FontWeight="Bold"
                                    FontSize="14">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="💾" FontSize="16" Margin="0,0,5,0"/>
                                    <TextBlock Text="설정 저장"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- 업데이트 설정 탭 -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔄" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="업데이트 설정"/>
                    </StackPanel>
                </TabItem.Header>
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- 현재 버전 -->
                            <Border Grid.Column="0" 
                                    Background="#FFF0F8FF" 
                                    BorderBrush="#FF0078D7" 
                                    BorderThickness="2" 
                                    CornerRadius="6"
                                    Padding="20,15"
                                    Margin="0,0,20,0">
                                <StackPanel>
                                    <TextBlock Text="현재 버전" 
                                               FontSize="11" 
                                               Foreground="#FF6C757D" 
                                               Margin="0,0,0,5"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="CurrentVersionTextBlock" 
                                               Text="v1.0.0" 
                                               FontSize="20" 
                                               FontWeight="Bold"
                                               Foreground="#FF0078D7"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <!-- 업데이트 확인 -->
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <Button x:Name="CheckUpdateButton" 
                                        Width="200" 
                                        Height="44"
                                        Click="CheckUpdateButton_Click"
                                        Background="#FF28A745" 
                                        Foreground="White"
                                        BorderThickness="0"
                                        Cursor="Hand"
                                        FontWeight="Bold"
                                        FontSize="14"
                                        HorizontalAlignment="Left">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🔄" FontSize="18" Margin="0,0,8,0"/>
                                        <TextBlock Text="지금 업데이트 확인"/>
                                    </StackPanel>
                                </Button>

                                <TextBlock x:Name="LastCheckTextBlock" 
                                           Text="" 
                                           FontSize="11" 
                                           Foreground="#FF6C757D" 
                                           Margin="0,10,0,5"/>

                                <TextBlock x:Name="RateLimitTextBlock" 
                                           Text="API 호출 제한: 정보 없음" 
                                           FontSize="11" 
                                           Foreground="#FF6C757D" 
                                           Margin="0,0,0,0"/>
                            </StackPanel>
                        </Grid>

                        <!-- 업데이트 상태 표시 패널 -->
                        <Border x:Name="UpdateStatusPanel"
                                Margin="0,20,0,0"
                                Padding="15"
                                BorderThickness="2"
                                CornerRadius="8"
                                Visibility="Collapsed">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock x:Name="UpdateStatusIcon"
                                           Text="✅"
                                           FontSize="32"
                                           VerticalAlignment="Top"
                                           Margin="0,0,15,0"/>

                                <StackPanel Grid.Column="1">
                                    <TextBlock x:Name="UpdateStatusTitle"
                                               Text="최신 버전입니다"
                                               FontSize="16"
                                               FontWeight="Bold"
                                               Margin="0,0,0,8"/>
                                    <TextBlock x:Name="UpdateStatusMessage"
                                               Text="현재 최신 버전을 사용 중입니다."
                                               FontSize="13"
                                               TextWrapping="Wrap"
                                               LineHeight="20"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- 접속 정보 관리 탭 -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔌" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="접속 정보 관리"/>
                    </StackPanel>
                </TabItem.Header>
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 설명 -->
                    <Border Grid.Row="0" 
                            Background="#FFF0F8FF" 
                            BorderBrush="#FF0078D7" 
                            BorderThickness="1" 
                            CornerRadius="4"
                            Padding="8,4"
                            HorizontalAlignment="Right"
                            Margin="0,0,0,10">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📌" 
                                       FontSize="12"
                                       Margin="0,0,5,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="데이터베이스 연결 정보를 관리합니다" 
                                       FontSize="11" 
                                       Foreground="#FF0078D7"
                                       FontWeight="SemiBold"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- ConnectionManagementControl 포함 -->
                    <local:ConnectionManagementControl x:Name="ConnectionManagement" 
                                                       Grid.Row="1"/>
                </Grid>
            </TabItem>

            <!-- 사업장 정보 관리 탭 -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🏭" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="사업장 정보 관리"/>
                    </StackPanel>
                </TabItem.Header>
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 설명 -->
                    <Border Grid.Row="0" 
                            Background="#FFF0F8FF" 
                            BorderBrush="#FF0078D7" 
                            BorderThickness="1" 
                            CornerRadius="4"
                            Padding="8,4"
                            HorizontalAlignment="Right"
                            Margin="0,0,0,10">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📌" 
                                       FontSize="12"
                                       Margin="0,0,5,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="사업장별 정보를 관리합니다" 
                                       FontSize="11" 
                                       Foreground="#FF0078D7"
                                       FontWeight="SemiBold"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- SiteManagementControl 포함 -->
                    <local:SiteManagementControl x:Name="SiteManagement"
                                                 Grid.Row="1"/>
                </Grid>
            </TabItem>
            
            <!-- 🔥 메타데이터 캐시 빌드 탭 (새로 추가) -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="💾" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="메타데이터 캐시"/>
                    </StackPanel>
                </TabItem.Header>
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel MaxWidth="900">
                        <!-- 안내 메시지 -->
                        <Border Background="#FFF0F8FF" 
                                BorderBrush="#FF0078D7" 
                                BorderThickness="2" 
                                CornerRadius="8"
                                Padding="20"
                                Margin="0,0,0,20">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                    <TextBlock Text="💡" 
                                               FontSize="24"
                                               Margin="0,0,12,0"/>
                                    <TextBlock Text="메타데이터 캐시 빌드" 
                                               FontSize="18" 
                                               FontWeight="Bold"
                                               Foreground="#FF0078D7"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock TextWrapping="Wrap" FontSize="13" Foreground="#FF495057" LineHeight="24">
                                    <Run FontWeight="SemiBold">오프라인 모드</Run>에서 사용할 <Run FontWeight="SemiBold">테이블 메타데이터를 미리 캐싱</Run>합니다.<LineBreak/>
                                    <LineBreak/>
                                    <Run FontWeight="Bold">• 캐시 빌드 과정:</Run><LineBreak/>
                                    　1. 데이터베이스에 연결<LineBreak/>
                                    　2. 모든 테이블 목록 조회<LineBreak/>
                                    　3. 각 테이블의 컬럼 정보 조회 및 저장<LineBreak/>
                                    　4. JSON 파일로 로컬에 저장<LineBreak/>
                                    <LineBreak/>
                                    <Run FontWeight="Bold">• 빌드된 캐시는 SQL Window 탭에서 사용됩니다.</Run>
                                </TextBlock>
                            </StackPanel>
                        </Border>

                        <!-- 접속 정보 선택 -->
                        <TextBlock Text="🔌 접속 정보 선택" 
                                   FontWeight="SemiBold" 
                                   FontSize="14"
                                   Margin="0,0,0,10"/>
                        <ComboBox x:Name="CacheConnectionComboBox"
                                  Height="44"
                                  FontSize="13"
                                  VerticalContentAlignment="Center"
                                  Padding="12,0"
                                  DisplayMemberPath="DisplayName"
                                  Margin="0,0,0,8"/>
                        <TextBlock Text="캐시를 빌드할 데이터베이스의 접속 정보를 선택하세요" 
                                   FontSize="11" 
                                   Foreground="#FF6C757D"
                                   Margin="0,0,0,25"/>

                        <!-- 빌드 버튼 -->
                        <Button x:Name="BuildCacheButton" 
                                Width="280" 
                                Height="54"
                                Click="BuildCacheButton_Click"
                                Background="#FF28A745" 
                                Foreground="White"
                                BorderThickness="0"
                                Cursor="Hand"
                                FontWeight="Bold"
                                FontSize="16"
                                HorizontalAlignment="Center"
                                Margin="0,0,0,20">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="🚀" FontSize="22" Margin="0,0,12,0"/>
                                <TextBlock Text="캐시 빌드 시작"/>
                            </StackPanel>
                        </Button>

                        <!-- 진행 상태 표시 -->
                        <Border x:Name="CacheBuildProgressPanel"
                                Margin="0,0,0,20"
                                Padding="20"
                                Background="#FFFEF5E7"
                                BorderBrush="#FFFFC107"
                                BorderThickness="2"
                                CornerRadius="8"
                                Visibility="Collapsed">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                    <TextBlock Text="⏳" FontSize="20" Margin="0,0,10,0"/>
                                    <TextBlock x:Name="CacheBuildStatusText"
                                               Text="캐시 빌드 진행 중..."
                                               FontSize="15"
                                               FontWeight="Bold"
                                               Foreground="#FF856404"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                <ProgressBar x:Name="CacheBuildProgressBar"
                                             Height="26"
                                             Minimum="0"
                                             Maximum="100"
                                             Value="0"
                                             Margin="0,0,0,12"/>
                                <TextBlock x:Name="CacheBuildDetailText"
                                           Text=""
                                           FontSize="12"
                                           Foreground="#FF856404"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <!-- 빌드 결과 표시 -->
                        <Border x:Name="CacheBuildResultPanel"
                                Padding="20"
                                BorderThickness="2"
                                CornerRadius="8"
                                Visibility="Collapsed">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                    <TextBlock x:Name="CacheBuildResultIcon"
                                               Text="✅"
                                               FontSize="28"
                                               Margin="0,0,12,0"/>
                                    <TextBlock x:Name="CacheBuildResultTitle"
                                               Text="캐시 빌드 완료"
                                               FontSize="18"
                                               FontWeight="Bold"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock x:Name="CacheBuildResultMessage"
                                           TextWrapping="Wrap"
                                           FontSize="13"
                                           LineHeight="24"/>
                            </StackPanel>
                        </Border>

                        <!-- 캐시 폴더 열기 버튼 -->
                        <Button x:Name="OpenCacheFolderButton2" 
                                Width="220" 
                                Height="42"
                                Click="OpenCacheFolderButton_Click"
                                Background="#FF6C757D" 
                                Foreground="White"
                                BorderThickness="0"
                                Cursor="Hand"
                                FontWeight="SemiBold"
                                FontSize="13"
                                HorizontalAlignment="Center"
                                Margin="0,15,0,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📂" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="캐시 폴더 열기"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- 🔥 DB 계정 일괄 변경 탭 (숨김 처리) -->
            <TabItem Visibility="Collapsed">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔑" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="DB 계정 일괄 변경"/>
                    </StackPanel>
                </TabItem.Header>
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel MaxWidth="800">
                        <!-- 안내 메시지 -->
                        <Border Background="#FFFEF5E7" 
                                BorderBrush="#FFFFC107" 
                                BorderThickness="2" 
                                CornerRadius="8"
                                Padding="15"
                                Margin="0,0,0,25">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="⚠️" 
                                               FontSize="20"
                                               Margin="0,0,10,0"/>
                                    <TextBlock Text="DB 계정 Password 일괄 변경" 
                                               FontSize="16" 
                                               FontWeight="Bold"
                                               Foreground="#FF856404"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock TextWrapping="Wrap" FontSize="13" Foreground="#FF856404" LineHeight="22">
                                    <Run FontWeight="Bold">TNS와 User ID</Run>를 기준으로 일치하는 항목들의 <Run FontWeight="Bold">Password</Run>를 일괄 변경합니다.<LineBreak/>
                                    <LineBreak/>
                                    변경 대상 테이블:<LineBreak/>
                                    • 쿼리 관리 (쿼리 실행/정보 조회/비즈 조회)<LineBreak/>
                                    • 접속 정보 관리<LineBreak/>
                                    <LineBreak/>
                                    <Run FontWeight="Bold" Foreground="#FFDC3545">⚠️ 주의: TNS, User ID, Password는 모두 필수 입력 항목입니다.</Run>
                                </TextBlock>
                            </StackPanel>
                        </Border>

                        <!-- TNS 입력 (필수) -->
                        <TextBlock Text="🔍 TNS 이름 (필수)" 
                                   FontWeight="SemiBold" 
                                   FontSize="14"
                                   Margin="0,0,0,10"/>
                        <TextBox x:Name="BulkTnsTextBox"
                                 Height="40"
                                 FontSize="13"
                                 VerticalContentAlignment="Center"
                                 Padding="12,0"
                                 Margin="0,0,0,5"/>
                        <TextBlock Text="변경할 대상 TNS 이름 (예: ORACLE_PRD)" 
                                   FontSize="11" 
                                   Foreground="#FF6C757D"
                                   Margin="0,0,0,20"/>

                        <!-- User ID 입력 (필수) -->
                        <TextBlock Text="👤 User ID (필수)" 
                                   FontWeight="SemiBold" 
                                   FontSize="14"
                                   Margin="0,0,0,10"/>
                        <TextBox x:Name="BulkUserIdTextBox"
                                 Height="40"
                                 FontSize="13"
                                 VerticalContentAlignment="Center"
                                 Padding="12,0"
                                 Margin="0,0,0,5"/>
                        <TextBlock Text="변경할 대상 User ID (예: admin)" 
                                   FontSize="11" 
                                   Foreground="#FF6C757D"
                                   Margin="0,0,0,20"/>

                        <!-- Password 입력 (필수) -->
                        <TextBlock Text="🔐 새 Password (필수)" 
                                   FontWeight="SemiBold" 
                                   FontSize="14"
                                   Margin="0,0,0,10"/>
                        <TextBox x:Name="BulkPasswordBox"
                                 Height="40"
                                 FontSize="13"
                                 VerticalContentAlignment="Center"
                                 Padding="12,0"
                                 Margin="0,0,0,5"/>
                        <TextBlock Text="위의 TNS와 User ID가 일치하는 모든 항목의 Password를 이 값으로 변경합니다" 
                                   FontSize="11" 
                                   Foreground="#FF6C757D"
                                   Margin="0,0,0,30"/>

                        <!-- 일괄 변경 버튼 -->
                        <Button x:Name="BulkUpdateButton" 
                                Width="250" 
                                Height="50"
                                Click="BulkUpdateButton_Click"
                                Background="#FFDC3545" 
                                Foreground="White"
                                BorderThickness="0"
                                Cursor="Hand"
                                FontWeight="Bold"
                                FontSize="16"
                                HorizontalAlignment="Center">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="🔑" FontSize="20" Margin="0,0,10,0"/>
                                <TextBlock Text="Password 일괄 변경"/>
                            </StackPanel>
                        </Button>

                        <!-- 변경 결과 표시 -->
                        <Border x:Name="BulkUpdateResultPanel"
                                Margin="0,30,0,0"
                                Padding="15"
                                BorderThickness="2"
                                CornerRadius="8"
                                Visibility="Collapsed">
                            <StackPanel>
                                <TextBlock x:Name="BulkUpdateResultTitle"
                                           Text="✅ 일괄 변경 완료"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           Margin="0,0,0,10"/>
                                <TextBlock x:Name="BulkUpdateResultMessage"
                                           TextWrapping="Wrap"
                                           FontSize="13"
                                           LineHeight="22"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- 🔥 테이블 단축어 관리 탭 (NEW) -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="⚡" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="테이블 단축어 관리"/>
                    </StackPanel>
                </TabItem.Header>
                <Grid Margin="10">
                    <!-- TableShortcutManagementControl 포함 -->
                    <local:TableShortcutManagementControl x:Name="TableShortcutManagement"/>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>
